(function(){var e=function(){return new Promise(function(e){chrome.tabs.captureVisibleTab(null,e)})},t=function(e){var t=null;chrome.tabs.onUpdated.addListener(function r(n,i){if(t&&n===t.id&&i.status==="loading"){chrome.tabs.onUpdated.removeListener(r);var s=chrome.extension.getViews().filter(function(e){return e.location.href===t.url})[0];s&&(s.screenshotUrl=e)}});var n=chrome.extension.getURL("editor.html?id="+Number(new Date));chrome.tabs.create({url:n},function(e){t=e})},n=function(){Promise.cast(e()).then(function(e){t(e)})};chrome.browserAction.onClicked.addListener(n)})();