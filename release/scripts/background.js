(function(){var e=function(e){return e.title==="Targetprocess Screen Capture"&&e.url.match(/^chrome-extension:\/\//)},t=function(){return new Promise(function(e){chrome.tabs.captureVisibleTab(null,e)})},n=function(e){var t=null;chrome.tabs.onUpdated.addListener(function r(n,i){if(t&&n===t.id&&i.status==="loading"){chrome.tabs.onUpdated.removeListener(r);var s=chrome.extension.getViews().filter(function(e){return e.location.href===t.url})[0];s&&(s.screenshotUrl=e)}});var n=chrome.extension.getURL("editor.html?id="+Number(new Date));chrome.tabs.create({url:n},function(e){t=e})},r=function(r){e(r)||Promise.cast(t()).then(function(e){n(e)})};chrome.browserAction.onClicked.addListener(r)})();